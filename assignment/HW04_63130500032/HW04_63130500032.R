# Library
library(dplyr)
library(readr)
library(stringr)
library(ggplot2)

# Dataset
prog_book <- read.csv('https://raw.githubusercontent.com/safesit23/INT214-Statistics/main/datasets/prog_book.csv')

# Observation the dataset
glimpse(prog_book)

# Check duplicate
prog_book %>% duplicated() %>% sum() 

# Check NA
prog_book %>% is.na() %>% sum()

# 1.????????????????????????????????????????????????????????????????????????????????? 10 ??????????????????
prog_book %>% filter(Price >= min(Price)) %>% select(Book_title,Price) %>% head(10)

# 2.?????????????????????????????????????????????????????????????????????????????????
prog_book %>% count(Type) %>% arrange(desc(n))

# 3.????????????????????????????????????????????????????????????????????? Hackers
prog_book %>% filter(str_detect(Book_title, "Hackers")) %>% select(Book_title)

# 4.??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????
prog_book %>% group_by(Type) %>% summarise(avg_page = mean(Number_Of_Pages))

# 5.?????????????????????????????????????????? Rating ????????????????????????
prog_book %>% filter(Rating == max(Rating)) %>% select(Book_title,Rating)

# 1.???????????????????????????????????????????????????????????????????????????????????????????????????
prog_book %>% ggplot(aes(x = Type ,y = Price, colour= Type)) + geom_jitter()

# 2.??????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????? 4.5 ??????????????????
prog_book %>% filter(Rating >= 4.5) %>% ggplot(aes(x = Rating ,y = Price)) + geom_line() + geom_point() + ggtitle("Relation between rating and price","When rating >= 4.5")
